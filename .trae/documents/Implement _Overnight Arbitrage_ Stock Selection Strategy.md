# 最终版隔夜套利策略开发计划 v1.1 (Final Overnight Arbitrage Plan v1.1)

新增功能：支持**指定板块筛选**。

## 1. 策略逻辑 (Strategy Logic)

### 输入参数 (Input)
- **`target_sectors` (可选)**：指定行业板块列表（如 `["半导体", "银行"]`）。
  - 若输入：仅在指定板块的成分股中进行筛选。
  - 若不输入（默认）：在全市场进行筛选。

### 基础过滤 (Base Filter)
- **剔除垃圾股**：非 ST，非退市，非停牌。
- **流动性门槛**：成交额 > 5000 万，换手率 > 2%。

### 维度 A：机构强力锁仓 (Smart Money Lock-in)
- **大盘股 (> 500亿)**：主力净占比 > 3.5%，小单净占比 < -2%。
- **中盘股 (50-500亿)**：主力净占比 > 5%，小单净占比 < -3%。
- **小盘股 (< 50亿)**：主力净占比 > 6.5%，小单净占比 < -4%。

### 维度 B：低位弹性起爆 (Low-level Reversal)
- **今日**：涨跌幅 < 3%，主力净流入 > 500 万。
- **昨日**：主力净流出 < -500 万。

### 维度 C：分歧中的领头羊 (Sector Divergence Leader)
- **板块范围**：若指定板块，则仅检查指定的板块；否则检查全市场行业板块。
- **板块筛选**：涨跌幅 -3% ~ 0%。
- **龙头定义**：板块内主力流入前 3 且 > 1000 万。

## 2. 技术实现 (Implementation)

### 阶段一：接口验证
- 运行 `verify_ak_cols.py` 确认字段。

### 阶段二：脚本开发 (`overnight_arbitrage.py`)
- **板块过滤逻辑**：
  - 若存在 `target_sectors`，循环调用 `ak.stock_board_industry_cons_em(sector)` 获取成分股代码集合。
  - 使用该集合对全市场数据进行 `isin` 过滤。
- **参数支持**：支持命令行参数 `--sectors "半导体,银行"`。

### 阶段三：验证
- 模拟运行：
  1. 全市场模式。
  2. 指定板块模式（如指定“银行”），验证输出结果是否仅包含银行股。

我将立即开始执行。