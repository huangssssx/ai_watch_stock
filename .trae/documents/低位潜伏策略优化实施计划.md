# 优化计划：低位潜伏策略（趋势修正版）

## 1. 核心改进
根据您的专业建议，我们将创建一个新的**极速选股脚本** `backend/scripts/选股策略/低位潜伏策略_趋势修正版.py`，核心改进如下：

### 逻辑层面 (Strategy Logic)
1.  **均线趋势过滤**：引入趋势保护，防止“接飞刀”。使用您建议的“量价趋势”替代方案（量比放大 + 换手活跃 + 价格低位但当日强势），确保右侧启动。
2.  **流动性安全垫**：新增 **流通市值 20亿 - 500亿** 筛选，剔除易被操控的微盘股和流动性差的标的。
3.  **资金强度确认**：保留量比 > 1.8 和换手率 2%-10% 的核心条件。

### 技术层面 (Technical Implementation)
1.  **极速运算**：**完全移除循环拉取历史数据**的逻辑。仅使用 `ak.stock_zh_a_spot_em()` 全市场快照，利用 Pandas 向量化计算，将运行时间从“分钟级”降低到“秒级”。
2.  **评分算法升级**：从 `Min-Max` 归一化改为 **`Rank` (百分位排名)**，有效抵抗异常值干扰。
3.  **非交易时间支持**：脚本将针对“非交易时间”进行适配（如周末/盘后），明确此时基于“最近一个交易日收盘数据”进行选股，并增加对数据有效性的基础检查（如量比是否为0），确保在复盘场景下可用。

## 2. 实施步骤
1.  **创建新脚本**：`backend/scripts/选股策略/低位潜伏策略_趋势修正版.py`。
2.  **编写代码**：
    - 移植并适配您提供的 Python 代码。
    - 增加 `if __name__ == "__main__":` 调试块。
    - 增加数据完整性检查（防止在集合竞价前/数据清零时段运行导致空结果）。
3.  **生成修改报告**：创建 `优化_Valley_Sniper_选股策略.md`，详细记录上述优化点和使用建议。

## 3. 下一步建议
- 建议在**收盘后（复盘）**或**开盘中（10:00后）**运行。
- 若在集合竞价时段运行，由于“量比/成交额”可能未生成，脚本将提示数据不足。
