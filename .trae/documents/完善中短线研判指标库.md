# 指标库检查与补充计划

## 1. 现状评估
经过检查数据库中的 `indicator_definitions` 表，您目前的指标库主要包含：
- **趋势类**：`ID 17` 包含了 MA (5/20/60)、MACD、RSI、ADX。
- **波动与突破类**：`ID 20` 包含了 布林带 (BOLL)、ATR、唐奇安通道。
- **基础数据**：日线、5分钟线、资金流向等。

## 2. 缺口分析
针对**中短线研判**（特别是波段操作和拐点捕捉），现有指标库缺少以下关键指标：
1.  **KDJ (随机指标)**：中短线最常用的灵敏指标，用于判断超买超卖和金叉死叉。
2.  **WR (威廉指标)**：比 KDJ 更灵敏的超买超卖指标，常用于辅助判断顶部和底部。
3.  **BIAS (乖离率)**：用于判断股价偏离均线的程度，捕捉急跌反弹或急涨回调的机会。

## 3. 实施计划：新增“中短线-震荡与反转”指标
我将为您实现一个新的组合指标，ID 暂定为自动增长（预计为 22），名称为 **“中短线-震荡与反转 (KDJ/WR/BIAS)”**。

### 技术实现细节
- **数据源**：复用 `akshare.stock_zh_a_hist` 接口获取日线 OHLCV 数据。
- **计算逻辑**（将写入数据库的 Python 代码字段）：
    1.  **KDJ (9, 3, 3)**：使用 Pandas 实现国内通用的 KDJ 算法（基于 EMA 平滑）。
    2.  **WR (14)**：计算威廉指标。
    3.  **BIAS (6, 12, 24)**：计算收盘价相对于 MA6、MA12、MA24 的乖离率。
    4.  **数据清洗**：保留最近 5 个交易日的数据，并格式化输出。

## 4. 执行步骤
1.  编写 Python 脚本 `scripts/add_oscillator_indicator.py`。
2.  该脚本将连接数据库，向 `indicator_definitions` 表插入上述新指标的定义。
3.  运行脚本完成添加。
4.  验证：通过简单的查询确认添加成功。

*注：60分钟级别的指标对中短线也很有意义，但为保持任务聚焦，本次先完善日线级别的震荡指标。如您需要分钟级指标，可随时告知。*