# 大盘分析脚本开发与数据库注入计划

根据您的指正，我将通过编写独立脚本的方式来实现功能，不修改任何系统原有代码。操作流程如下：

## 1. 验证阶段：确保数据源有效性
编写并运行临时脚本 `backend/scripts/verify_akshare_data.py`，测试以下 Akshare 接口的连通性和响应速度，确保“数据正确性”：
*   **核心指数**：`stock_zh_index_spot` (上证、深证、创业板)
*   **北向资金**：`stock_hsgt_north_net_flow_in_em` (实时净流入)
*   **行业板块**：`stock_board_industry_name_em` (涨幅前十行业)
*   **全市场概况**：`stock_sse_summary` / `stock_szse_summary` (用于计算涨跌家数分布，比全市场快照更高效)

## 2. 注入阶段：编写 Streamlit 脚本并注入 DB
编写注入脚本 `backend/scripts/inject_market_dashboard.py`，将完整的 Streamlit 仪表盘代码作为一条记录插入到 `research_scripts` 数据库表中。

### 仪表盘脚本逻辑 (将存入 DB 的内容)
*   **交互**：利用 Streamlit 的 `st.cache_data` 实现数据缓存，并提供“🔄 立即刷新”按钮。
*   **布局**：
    *   **顶部指标带**：上证指数、深证成指、创业板指（点位 + 涨跌幅）。
    *   **资金情绪带**：北向资金流入额、全市场成交额（如有）、涨/跌/平家数分布。
    *   **核心图表**：
        *   **行业热度榜**：Top 10 领涨行业横向柱状图。
        *   **赚钱效应分布**：上涨/下跌家数比例饼图或进度条。

## 3. 预期结果
执行注入脚本后，您将在“数据实验室”的脚本列表中看到名为 **“Data Lab - Market Sentiment Dashboard”** 的项目。在前端选择该脚本并点击“运行 Streamlit”即可使用。

我将按顺序执行：验证数据 -> 注入数据库。
